import streamlit as st 
 


from pandas_datareader import data as pdr
import pandas as pd

import yfinance as yf
yf.pdr_override()
nifty_total_market=['DALMIASUG',
 'USHAMART',
 'GICRE',
 'DAAWAT',
 'UTIAMC',
 'BAJAJHIND',
 'SCI',
 'JBMA',
 'PNBHOUSING',
 'NIACL',
 'INDORAMA',
 'NRBBEARING',
 'SUZLON',
 'HUDCO',
 'CSBBANK',
 'LICI',
 'MAITHANALL',
 'RKFORGE',
 'GPIL',
 'KIRLFER',
 'RENUKA',
 'DWARKESH',
 'GODFRYPHLP',
 'DFMFOODS',
 'VESUVIUS',
 'KTKBANK',
 'HCC',
 'ENGINERSIN',
 'MAHABANK',
 'STEELXIND',
 'POLICYBZR',
 'JUSTDIAL',
 'DBL',
 'ELECTCAST',
 'JINDALSAW',
 'HEMIPROP',
 'ADANIPORTS',
 'VARROC',
 'GMRINFRA',
 'GRSE',
 'BHEL',
 'NLCINDIA',
 'SUNDARMFIN',
 'CANFINHOME',
 'INDIGO',
 'HERITGFOOD',
 'IDFC',
 'SHILPAMED',
 'INDIAMART',
 'JKPAPER',
 'ANDHRSUGAR',
 'ROLEXRINGS',
 'BBTC',
 'WSTCSTPAPR',
 'JKIL',
 'SONATSOFTW',
 'ORISSAMINE',
 'CREDITACC',
 'IRCON',
 'COSMOFIRST',
 'ADANIENT',
 'APARINDS',
 'M&M',
 'CUMMINSIND',
 'HCG',
 'KRBL',
 'IMFA',
 'KARURVYSYA',
 'JPASSOCIAT',
 'EICHERMOT',
 'KALYANKJIL',
 'IGL',
 'MOIL',
 'ASHOKLEY',
 'POWERGRID',
 'DATAPATTNS',
 'SEAMECLTD',
 'IFCI',
 'NOCIL',
 'CONFIPET',
 'JKLAKSHMI',
 'ASHOKA',
 'CARYSIL',
 'PAGEIND',
 'CANBK',
 'OPTIEMUS',
 'JPPOWER',
 'GABRIEL',
 'DMART',
 'LXCHEM',
 'MANYAVAR',
 'RTNPOWER',
 'HATHWAY',
 'CARERATING',
 'HDFCAMC',
 'HAL',
 'MARICO',
 'LINDEINDIA',
 'VIDHIING',
 'IBREALEST',
 'VEDL',
 'RECLTD',
 'SANSERA',
 'MANAPPURAM',
 'CARBORUNIV',
 'BAJAJ-AUTO',
 'CHOLAFIN',
 'SYMPHONY',
 'IRFC',
 'INDIAGLYCO',
 'INDOCO',
 'ABSLAMC',
 'BAJAJCON',
 'APCOTEXIND',
 'THOMASCOOK',
 'ABB',
 'SIYSIL',
 'BALMLAWRIE',
 'ALOKINDS',
 'MAHINDCIE',
 'SAGCEM',
 'DCBBANK',
 'SIEMENS',
 'BAJAJFINSV',
 'IRB',
 'BHARTIARTL',
 'HEROMOTOCO',
 'ICICIPRULI',
 'RATEGAIN',
 'AUTOAXLES',
 'DALBHARAT',
 'SPANDANA',
 'IBULHSGFIN',
 'NESTLEIND',
 'HINDCOPPER',
 'RBLBANK',
 'BRITANNIA',
 'PFC',
 'MMTC',
 'DRREDDY',
 'IDEA',
 'L&TFH',
 'CUB',
 'PRUDENT',
 'MGL',
 'AMBUJACEM',
 'INDIACEM',
 'ANANTRAJ',
 'VOLTAMP',
 'TRIVENI',
 'NFL',
 'TVTODAY',
 'PRAJIND',
 'AMIORG',
 'HDFCLIFE',
 'JINDALSTEL',
 'BATAINDIA',
 'TVSMOTOR',
 'VMART',
 'HIKAL',
 'ADANITRANS',
 'ARVINDFASN',
 'WELENT',
 'HDFC',
 'WOCKPHARMA',
 'HINDUNILVR',
 'DELTACORP',
 'MARUTI',
 'SUNCLAYLTD',
 'SONACOMS',
 'SUPREMEIND',
 'DABUR',
 'GODREJPROP',
 'THERMAX',
 'EMUDHRA',
 'TITAN',
 'ABFRL',
 'GOCOLORS',
 'GUJALKALI',
 'MCDOWELL-N',
 'SUNTV',
 'ITC',
 'LICHSGFIN',
 'RELIANCE',
 'GANESHHOUC',
 'BOROLTD',
 'BAJFINANCE',
 'ENDURANCE',
 'AIAENG',
 'VRLLOG',
 'KRSNAA',
 'MARKSANS',
 'NAVNETEDUL',
 'REDINGTON',
 'MFSL',
 'VSTTILLERS',
 'AXISBANK',
 'PARAS',
 'IOC',
 'BEL',
 'TATASTLLP',
 'GEOJITFSL',
 'NBCC',
 'BLS',
 'PCBL',
 'NAVA',
 'GESHIP',
 'BLUEDART',
 'SCHAEFFLER',
 'EIDPARRY',
 'RBA',
 'INTELLECT',
 'VBL',
 'SPICEJET',
 'ABCAPITAL',
 'STAR',
 'AMARAJABAT',
 'HINDZINC',
 'APOLLOHOSP',
 'GATEWAY',
 'COALINDIA',
 'YESBANK',
 'KPITTECH',
 'FORCEMOT',
 'ESCORTS',
 'PIIND',
 'ISGEC',
 'TIINDIA',
 'BDL',
 'IDFCFIRSTB',
 'JSWISPL',
 'ULTRACEMCO',
 'MHRIL',
 'ABBOTINDIA',
 'NATIONALUM',
 'MAZDOCK',
 'SCHNEIDER',
 'NAUKRI',
 'EASEMYTRIP',
 'PRIVISCL',
 'JAICORPLTD',
 'BEPL',
 'KOTAKBANK',
 'COLPAL',
 'SAPPHIRE',
 'DHANUKA',
 'NTPC',
 'ISEC',
 'LTIM',
 'SBILIFE',
 'LAOPALA',
 'TORNTPOWER',
 'NCC',
 'GLOBUSSPR',
 'M&MFIN',
 'PVR',
 'KNRCON',
 'TATACOMM',
 'KIMS',
 'GUJGASLTD',
 'HAVELLS',
 'PRESTIGE',
 'GODREJCP',
 'HEIDELBERG',
 'MASTEK',
 'ACC',
 'SBICARD',
 'AETHER',
 'CAMLINFINE',
 'UNOMINDA',
 'TATVA',
 'MRF',
 'MPHASIS',
 'VGUARD',
 'RUPA',
 'SRTRANSFIN',
 'ICICIGI',
 'LTTS',
 'WHIRLPOOL',
 'ARVIND',
 'NEOGEN',
 'CHENNPETRO',
 'PETRONET',
 'ASIANPAINT',
 'DBREALTY',
 'SURYAROSNI',
 'STLTECH',
 'DLF',
 'SIS',
 'TATACOFFEE',
 'GARFIBRES',
 'IIFLSEC',
 'BOMDYEING',
 'MCX',
 'DHANI',
 'MUTHOOTFIN',
 'CIPLA',
 'IRCTC',
 'TATACONSUM',
 'BESTAGRO',
 'BFUTILITIE',
 'ADANIGREEN',
 'ATGL',
 'GAIL',
 'RALLIS',
 'ICRA',
 'ETHOSLTD',
 'GOKEX',
 'RAIN',
 'HINDALCO',
 'VSTIND',
 'SSWL',
 'DIVISLAB',
 'COCHINSHIP',
 'SPLPETRO',
 'INDUSTOWER',
 'TATASTEEL',
 'DIXON',
 'PRSMJOHNSN',
 'ZEEL',
 'TECHM',
 'JSWSTEEL',
 'BHARATFORG',
 'ICICIBANK',
 'GUFICBIO',
 'JSL',
 'RTNINDIA',
 'BALKRISIND',
 'INOXLEISUR',
 'FINOPB',
 'POWERINDIA',
 'IIFL',
 'PAISALO',
 'SAIL',
 'AARTIDRUGS',
 'AHLUCONT',
 'CGCL',
 'KEI',
 'CROMPTON',
 'ITI',
 'LT',
 'FORTIS',
 'PSPPROJECT',
 'AUBANK',
 'APLAPOLLO',
 'NEULANDLAB',
 'MOLDTKPAC',
 'BIRLACORPN',
 'ALEMBICLTD',
 'BANKBARODA',
 'RHIM',
 'SHYAMMETL',
 'CCL',
 'HDFCBANK',
 'MIDHANI',
 'GRASIM',
 'TECHNOE',
 'UBL',
 'RAMCOCEM',
 'SBIN',
 'UNIONBANK',
 'VINATIORGA',
 'ORIENTCEM',
 'WESTLIFE',
 'ATUL',
 'FEDERALBNK',
 'TRENT',
 'BAJAJHLDNG',
 'GOODYEAR',
 'SHREECEM',
 'SUBEXLTD',
 'HAPPSTMNDS',
 'INDIGOPNTS',
 'APOLLOTYRE',
 'LODHA',
 'TATAINVEST',
 'ORIENTELEC',
 'TORNTPHARM',
 'TRITURBINE',
 'TANLA',
 'FILATEX',
 'DATAMATICS',
 'EQUITASBNK',
 'GAEL',
 'DEN',
 'NAVINFLUOR',
 'TIRUMALCHM',
 'EXIDEIND',
 'THYROCARE',
 'BHARATRAS',
 'DOLATALGO',
 'OBEROIRLTY',
 'MAHLIFE',
 'IPL',
 'EKC',
 'VOLTAS',
 'HBLPOWER',
 'FDC',
 'BOSCHLTD',
 'JKCEMENT',
 'HCLTECH',
 'PIDILITIND',
 'KSCL',
 'SWANENERGY',
 'GSPL',
 'IEX',
 'SJVN',
 'LAURUSLABS',
 'METROBRAND',
 'KSB',
 'BECTORFOOD',
 'TEJASNET',
 'IDBI',
 'ADVENZYMES',
 '3MINDIA',
 'HEG',
 'SUDARSCHEM',
 'IPCALAB',
 'DCAL',
 'SANOFI',
 'DOLLAR',
 'ASTRAZEN',
 'HGS',
 'ICIL',
 'ZYDUSLIFE',
 'SHK',
 'TINPLATE',
 'IFBIND',
 'CDSL',
 'WIPRO',
 'SHOPERSTOP',
 'BCG',
 'ZOMATO',
 'RATNAMANI',
 'RPOWER',
 'INDOSTAR',
 'GTLINFRA',
 'VAKRANGEE',
 'PHOENIXLTD',
 'DISHTV',
 'BRIGADE',
 'RAJRATAN',
 'INDHOTEL',
 'ZFCVINDIA',
 'VIPIND',
 'HINDWAREAP',
 'METROPOLIS',
 'SUMICHEM',
 'HINDOILEXP',
 'LUPIN',
 'CHALET',
 'KANSAINER',
 'POONAWALLA',
 'FAIRCHEMOR',
 'NH',
 'ASTERDM',
 'TATAPOWER',
 'RVNL',
 'HINDPETRO',
 'KEC',
 'BALAMINES',
 'TATAMETALI',
 'NEWGEN',
 'TIIL',
 'TIMETECHNO',
 'FCL',
 'RPSGVENT',
 'ESABINDIA',
 'JYOTHYLAB',
 'INEOSSTYRO',
 'GATI',
 'MTARTECH',
 'BASF',
 'MOTHERSON',
 'SRF',
 'HATSUN',
 'MAHSCOOTER',
 'LUXIND',
 'CONCOR',
 'RELAXO',
 'RAYMOND',
 'OLECTRA',
 'AMRUTANJAN',
 'AGI',
 'MANINFRA',
 'IOLCP',
 'SURYODAY',
 'HSCL',
 'RAINBOW',
 'GLENMARK',
 'BPCL',
 'JUBLFOOD',
 'JINDALPOLY',
 'PFIZER',
 'ZYDUSWELL',
 'MRPL',
 'HFCL',
 'LALPATHLAB',
 'GREENPANEL',
 'TATACHEM',
 'GRANULES',
 'GRAPHITE',
 'FINEORG',
 'UPL',
 'NAM-INDIA',
 'SARDAEN',
 'SOMANYCERA',
 'WELCORP',
 'TASTYBITE',
 'CYIENT',
 'SAREGAMA',
 'SFL',
 'TCIEXP',
 'GRWRHITECH',
 'ANANDRATHI',
 'BERGEPAINT',
 'APOLLOPIPE',
 'CRISIL',
 'SEQUENT',
 'CAPLIPOINT',
 'QUESS',
 'MOTILALOFS',
 'PERSISTENT',
 'ALKYLAMINE',
 'BARBEQUE',
 'AVANTIFEED',
 'TEGA',
 'GRINFRA',
 'BLUESTARCO',
 'SHARDACROP',
 'CASTROLIND',
 'HERANBA',
 'AAVAS',
 'JKTYRE',
 'MANALIPETC',
 'SBCL',
 'MSTCLTD',
 'MAXHEALTH',
 'HONAUT',
 'INDUSINDBK',
 'TATAMTRDVR',
 'APLLTD',
 'SHAREINDIA',
 'OFSS',
 'PATANJALI',
 'SKFINDIA',
 'VALIANTORG',
 'RELIGARE',
 'MAYURUNIQ',
 'VIJAYA',
 'GLS',
 'NESCO',
 'GLAND',
 'DEVYANI',
 'SUNPHARMA',
 'DEEPAKNTR',
 'PGHL',
 'MOREPENLAB',
 'KCP',
 'SUPRIYA',
 'ANURAS',
 'CERA',
 'UFLEX',
 'JINDWORLD',
 'RAILTEL',
 'LGBBROSLTD',
 'BSOFT',
 'RELINFRA',
 'AKZOINDIA',
 'GULFOILLUB',
 'RADICO',
 'HLEGLAS',
 'JAMNAAUTO',
 'GMMPFAUDLR',
 'FACT',
 'VENKEYS',
 'STOVEKRAFT',
 'ROSSARI',
 'GALAXYSURF',
 'ASTRAL',
 'SAFARI',
 'INFY',
 'AJANTPHARM',
 'AUROPHARMA',
 'TATAMOTORS',
 'SYRMA',
 'GRAVITA',
 'ONGC',
 'BALRAMCHIN',
 'TCI',
 'POLYCAB',
 'GPPL',
 'CHOICEIN',
 'BUTTERFLY',
 'APTUS',
 'ALLCARGO',
 'ROUTE',
 'GLAXO',
 'TATAELXSI',
 'BANDHANBNK',
 'GODREJIND',
 'POLYPLEX',
 'POKARNA',
 'PAYTM',
 'GMDCLTD',
 'EDELWEISS',
 'JUBLPHARMA',
 'J&KBANK',
 'CAMS',
 'GREAVESCOT',
 'SUVENPHAR',
 'FSL',
 'GODREJAGRO',
 'BIOCON',
 'KALPATPOWR',
 'OMAXE',
 'VTL',
 'SYNGENE',
 'CIGNITITEC',
 'AMBER',
 'TIMKEN',
 'AWL',
 'TCS',
 'LAXMIMACH',
 'CENTURYTEX',
 'HIL',
 'TCNSBRANDS',
 'NETWORK18',
 'IIFLWAM',
 'EMAMILTD',
 'KIRIINDUS',
 'JUBLINGREA',
 'GNFC',
 'BAYERCROP',
 'BANKINDIA',
 'KIRLOSENG',
 'JCHAC',
 'MAPMYINDIA',
 'LATENTVIEW',
 'OIL',
 'INGERRAND',
 'MFL',
 'CHOLAHLDNG',
 'CGPOWER',
 'NAZARA',
 'ZENSARTECH',
 'INDIANB',
 'EVEREADY',
 'ASAHIINDIA',
 'GREENPLY',
 'MATRIMONY',
 'BORORENEW',
 'SOLARA',
 'BAJAJELEC',
 'PNB',
 'TTKPRESTIG',
 'TIDEWATER',
 'CARTRADE',
 'NUVOCO',
 'MSUMI',
 'SUNTECK',
 'MASFIN',
 'ECLERX',
 'COROMANDEL',
 'TARSONS',
 'MINDACORP',
 'JMFINANCIL',
 'FINCABLES',
 'STARHEALTH',
 'CLEAN',
 'POLYMED',
 'COFORGE',
 'FLUOROCHEM',
 'MMFL',
 'CESC',
 'JISLJALEQS',
 'ELECON',
 'IONEXCHANG',
 'VAIBHAVGBL',
 'PNCINFRA',
 'ALKEM',
 'AFFLE',
 'MAHLOG',
 'MOL',
 'CENTURYPLY',
 'ACE',
 'GRINDWELL',
 'CRAFTSMAN',
 'IGPL',
 'ASTRAMICRO',
 'NHPC',
 'HGINFRA',
 'PANAMAPET',
 'BSE',
 'SWSOLAR',
 'KPRMILL',
 'IOB',
 'ASTEC',
 'KAJARIACER',
 'KOLTEPATIL',
 'CEATLTD',
 'TEAMLEASE',
 'SOUTHBANK',
 'NATCOPHARM',
 'PGHH',
 'TV18BRDCST',
 'JSWENERGY',
 'HOMEFIRST',
 'HIMATSEIDE',
 'NYKAA',
 'ANGELONE',
 'DCMSHRIRAM',
 'PARADEEP',
 'INOXWIND',
 'CMSINFO',
 'SOLARINDS',
 'AEGISCHEM',
 'INFIBEAM',
 'ACCELYA',
 'CAMPUS',
 'ELGIEQUIP',
 'EIHOTEL',
 'GSFC',
 'FINPIPE',
 'UJJIVANSFB',
 'KENNAMET',
 'SUPRAJIT',
 'RESPONIND',
 'SPARC',
 'PRINCEPIPE',
 'JBCHEPHARM',
 'SOBHA',
 'SUNDRMFAST',
 'DELHIVERY',
 'MEDPLUS',
 'RITES',
 'NIITLTD',
 'TRIDENT',
 'WABAG',
 'RAJESHEXPO',
 'TTML',
 'CHAMBLFERT',
 'CENTRALBK',
 'DEEPAKFERT',
 'LEMONTREE',
 'HNDFDS',
 'RCF',
 'WELSPUNIND',
 'CHEMPLASTS',
 'EPL',
 'MAHSEAMLES']
dropdown=st.selectbox("Pick your Asset",nifty_total_market)
ab=dropdown
dropdown=dropdown+".NS"

start_date=st.date_input("Start",value=pd.to_datetime('2022-01-01'))
end_date=st.date_input("End",value=pd.to_datetime('today'))

if len(dropdown)>0 :
    df= pdr.get_data_yahoo(dropdown, start=start_date, end=end_date)
    
st.sidebar.subheader('Settings')
st.sidebar.caption('Adjust charts settings and then press apply')

with st.sidebar.form('settings_form'):
    show_nontrading_days = st.checkbox('Show non-trading days', True)
    
    chart_styles = [
        'default', 'binance', 'blueskies', 'brasil', 
        'charles', 'checkers', 'classic', 'yahoo',
        'mike', 'nightclouds', 'sas', 'starsandstripes'
    ]
    chart_style = st.selectbox('Chart style', options=chart_styles, index=chart_styles.index('mike'))
    chart_types = [
        'candle', 'ohlc', 'line', 'renko', 'pnf'
    ]
    chart_type = st.selectbox('Chart type', options=chart_types, index=chart_types.index('candle'))

    mav1 = st.number_input('Mav 1', min_value=3, max_value=300, value=3, step=1)
    mav2 = st.number_input('Mav 2', min_value=3, max_value=300, value=6, step=1)
    mav3 = st.number_input('Mav 3', min_value=3, max_value=300, value=9, step=1)

    st.form_submit_button('Apply')
import mplfinance as mpf 
fig, ax = mpf.plot(
        df,
        title=f'{ab} Chart',
        type=chart_type,
        show_nontrading=show_nontrading_days,
        mav=(int(mav1),int(mav2),int(mav3)),
        volume=True,

        style=chart_style,
        figsize=(15,10),
        
       
        returnfig=True
    )    
st.pyplot(fig)
